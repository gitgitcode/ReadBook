#网站
---

###大型网站
    日均 超过pv100万
*   高并发 大流量
    
        apache 200pv 平均每秒  -受限业务逻辑
	    google 40509 pv35亿
*   高可用  （7*24 备份）

*   海量数据 （MySQL存储 存储数据几千万 ）

*   需求迭代 发布频繁 

##构架要素
    
* 高性能 
* 高可用
* 扩展性

* 高可用
        可用性 99.99% 一年 
        2个9基本可用  年度小于88小时
        3个9 9小时
        4个9 自动恢复功能的高可用
        5个9 年度小于5分钟
         
        1.负载均衡 lvs ngnix haproxy keepalived 
        2.双机互备 mysql mongodb ReplicaSet
        3.自动恢复 
        
        
*   高性能
        高缓存 并行计算 系统优化
        
        tps  
        系统最佳运行点 最大负载点 崩溃点
        ab  - n 总共请求 -c 每秒发送 ab -n -c http://127.0.0.1/ requests per second 每秒 能承受的请求量
        jmeter
        loadrunner
        
*  可扩展
        开发框架 多层设计 业务分割       
	    

##   架构演化

        物理分离 不同业务伸缩 ->
       
        增加页面缓存 ->
    	页面片段缓存 ->
    	数据缓存 memache  ->
    	增加webserver ->
    	分库  ->
    	分表 DAL和分布式缓存 ->
    	更多的webserver 分布式文件系统 ->
    	读写分离 存储 ->
    	大型分布式应用和集群  队列
        
        多域名域名业务分离


## 大型网站核心思想

*  ‘分’而治之，分是根本      
    
	水平  apache服务 ， 表太大 user1users3users2 单表；不同业务；
	垂直  DAL 数据 user用户中，blog单独 ；应用层，服务层，数据层
	分布式 应用服务资源数据计算
	动静分离
	集群

*   缓存  
	数据 浏览器缓存 cdn

*   异步消息队列
	 异步消息队列（producer-〉mq->consumer 性能，强壮，速度，并发）
	
*   自动化
	自动化代码 自动化测试 自动化部署 自动化监控 自动化报警 安全检测 失效转移和恢复

*   精益求精，优化每一个细节
	linux 优化  依据业务选购 优化tcp 文件数打开限制
	apache 优化 运行模式
	mysql  优化
	php    优化

###   web前端优化
            减少http请求
            使用浏览器缓存 缓存时间
        	内容压缩 
		    gzip,deflate,sdch
            采集时解压缩
	        减少cookic的传输 
		    不同的域名 ie6只能打开两个链接
		    加快访问速度 浏览器并发访问
	        css放在最上面
	        javascript 放在最下面 
